<!-- Modal -->
<div class="modal">
  <div class="modal-content">
    <div class="title-modal">
      <h2>Agregar Proveedor</h2>
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" width="28" height="28" stroke-width="1.25">
        <path d="M5 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0"></path>
        <path d="M3 21v-2a4 4 0 0 1 4 -4h4c.96 0 1.84 .338 2.53 .901"></path>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        <path d="M16 19h6"></path>
        <path d="M19 16v6"></path>
      </svg>
    </div>

    <form [formGroup]="supplierForm" (ngSubmit)="guardarProveedor()">
      <!-- Fila de Nombre y Correo -->
      <div class="input-row">
        <!-- Campo de nombre -->
        <div class="input-wrapper">
          <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" width="28" height="28" stroke-width="1.25">
            <path d="M3 17c3.333 -3.333 5 -6 5 -8c0 -3 -1 -3 -2 -3s-2.032 1.085 -2 3c.034 2.048 1.658 4.877 2.5 6c1.5 2 2.5 2.5 3.5 1l2 -3c.333 2.667 1.333 4 3 4c.53 0 2.639 -2 3 -2c.517 0 1.517 .667 3 2"></path>
          </svg>
          <input 
            placeholder="Nombre" 
            class="form-input" 
            type="text" 
            formControlName="nombre"
            [class.invalid]="nombreInvalid"
          />
          <div class="error-message" *ngIf="nombreInvalid">
            <span *ngIf="supplierForm.get('nombre')?.errors?.['required']">El nombre es obligatorio</span>
          </div>
        </div>

        <!-- Campo de correo electrónico -->
        <div class="input-wrapper">
          <svg fill="none" viewBox="0 0 24 24" class="input-icon">
            <path stroke-width="1.5" stroke="currentColor" d="M3 8L10.8906 13.2604C11.5624 13.7083 12.4376 13.7083 13.1094 13.2604L21 8M5 19H19C20.1046 19 21 18.1046 21 17V7C21 5.89543 20.1046 5 19 5H5C3.89543 5 3 5.89543 3 7V17C3 18.1046 3.89543 19 5 19Z"></path>
          </svg>
          <input 
            placeholder="Correo Electrónico" 
            class="form-input" 
            type="email" 
            formControlName="correo"
            [class.invalid]="correoInvalid"
          />
          <div class="error-message" *ngIf="correoInvalid">
            <span *ngIf="supplierForm.get('correo')?.errors?.['required']">El correo es obligatorio</span>
            <span *ngIf="supplierForm.get('correo')?.errors?.['email']">Formato de correo inválido</span>
          </div>
        </div>
      </div>

      <!-- Fila de Teléfono y Dirección -->
      <div class="input-row">
        <!-- Campo de teléfono -->
        <div class="input-wrapper">
          <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" width="28" height="28" stroke-width="1.25">
            <path d="M6 5a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2v-14z"></path>
            <path d="M11 4h2"></path>
            <path d="M12 17v.01"></path>
          </svg>
          <input 
            placeholder="Teléfono" 
            class="form-input" 
            type="text" 
            formControlName="telefono"
            [class.invalid]="telefonoInvalid"
          />
          <div class="error-message" *ngIf="telefonoInvalid">
            <span *ngIf="supplierForm.get('telefono')?.errors?.['required']">El teléfono es obligatorio</span>
          </div>
        </div>

        <!-- Campo de dirección -->
        <div class="input-wrapper">
          <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" width="28" height="28" stroke-width="1.25">
            <path d="M12 12l8 -4.5"></path>
            <path d="M12 12v9"></path>
            <path d="M12 12l-8 -4.5"></path>
            <path d="M12 12l8 4.5"></path>
            <path d="M12 3v9"></path>
            <path d="M12 12l-8 4.5"></path>
          </svg>
          <input 
            placeholder="Dirección" 
            class="form-input" 
            type="text" 
            formControlName="direccion"
            [class.invalid]="direccionInvalid"
          />
          <div class="error-message" *ngIf="direccionInvalid">
            <span *ngIf="supplierForm.get('direccion')?.errors?.['required']">La dirección es obligatoria</span>
          </div>
        </div>
      </div>

      <!-- Fila de RFC y Contacto Principal -->
      <div class="input-row">
        <!-- Campo de RFC -->
        <div class="input-wrapper">
          <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" width="28" height="28" stroke-width="1.25">
            <path d="M12 3a12 12 0 0 0 8.5 3a12 12 0 0 1 -8.5 15a12 12 0 0 1 -8.5 -15a12 12 0 0 0 8.5 -3"></path>
            <path d="M12 3v18"></path>
          </svg>
          <input 
            placeholder="RFC" 
            class="form-input" 
            type="text" 
            formControlName="rfc"
            [class.invalid]="rfcInvalid"
          />
          <div class="error-message" *ngIf="rfcInvalid">
            <span *ngIf="supplierForm.get('rfc')?.errors?.['required']">El RFC es obligatorio</span>
          </div>
        </div>

        <!-- Campo de Contacto Principal -->
        <div class="input-wrapper">
          <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" width="28" height="28" stroke-width="1.25">
            <path d="M12 12l8 -4.5"></path>
            <path d="M12 12v9"></path>
            <path d="M12 12l-8 -4.5"></path>
            <path d="M12 12l8 4.5"></path>
            <path d="M12 3v9"></path>
            <path d="M12 12l-8 4.5"></path>
          </svg>
          <input 
            placeholder="Contacto Principal" 
            class="form-input" 
            type="text" 
            formControlName="contactoPrincipal"
            [class.invalid]="contactoPrincipalInvalid"
          />
          <div class="error-message" *ngIf="contactoPrincipalInvalid">
            <span *ngIf="supplierForm.get('contactoPrincipal')?.errors?.['required']">El contacto principal es obligatorio</span>
          </div>
        </div>
      </div>

      <!-- Fila de Tipo de Proveedor y Categoría -->
      <div class="input-row">
        <!-- Campo de Tipo de Proveedor -->
        <div class="input-wrapper">
          <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" width="28" height="28" stroke-width="1.25">
            <path d="M12 3a12 12 0 0 0 8.5 3a12 12 0 0 1 -8.5 15a12 12 0 0 1 -8.5 -15a12 12 0 0 0 8.5 -3"></path>
            <path d="M12 3v18"></path>
          </svg>
          <select 
            class="form-input" 
            formControlName="tipoProveedor"
            [class.invalid]="tipoProveedorInvalid"
          >
            <option value="" disabled>Selecciona el Tipo de Proveedor</option>
            <option value="nacional">Nacional</option>
            <option value="internacional">Internacional</option>
          </select>
          <div class="error-message" *ngIf="tipoProveedorInvalid">
            <span *ngIf="supplierForm.get('tipoProveedor')?.errors?.['required']">El tipo de proveedor es obligatorio</span>
          </div>
        </div>

        <!-- Campo de Categoría -->
        <!-- Campo de Categoría (Selección múltiple) -->
<div class="input-wrapper">
  <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" width="28" height="28" stroke-width="1.25">
    <path d="M12 12l8 -4.5"></path>
    <path d="M12 12v9"></path>
    <path d="M12 12l-8 -4.5"></path>
    <path d="M12 12l8 4.5"></path>
    <path d="M12 3v9"></path>
    <path d="M12 12l-8 4.5"></path>
  </svg>
  
  <div class="multiselect-container" [class.invalid]="categoriaProductosInvalid">
    <div class="multiselect-header" (click)="toggleCategoriasDropdown()">
      <div class="multiselect-placeholder">{{ getSelectedCategoriasText() }}</div>
      <div class="multiselect-arrow">▼</div>
    </div>
    
    <div class="multiselect-dropdown" *ngIf="showCategoriasDropdown">
      <div class="multiselect-option" *ngFor="let categoria of categorias">
        <mat-checkbox 
          [checked]="isCategoriaSelected(categoria._id)" 
          (change)="onCategoriaChange($event, categoria._id)">
          {{ categoria.nombre }}
        </mat-checkbox>
      </div>
    </div>
  </div>
  
  <div class="error-message" *ngIf="categoriaProductosInvalid">
    <span *ngIf="supplierForm.get('categoriaProductos')?.errors?.['required']">Selecciona al menos una categoría</span>
  </div>
</div>
      </div>

      <!-- Botones -->
      <div class="buttons">
        <button type="button" class="cancel-btn" (click)="onNoClick()">Cancelar</button>
        <button 
          type="submit" 
          class="button-primary" 
          [disabled]="supplierForm.invalid || isLoading"
        >
          {{ isLoading ? 'Guardando...' : 'Guardar' }}
        </button>
      </div>
    </form>
  </div>
</div>